import{_ as Y,u as J,s as G,l as V,z as K,o as Q,A as W,m as Z,k as O,w as S,r as ee,h as g,a as M,f as b,e as A,b as t,i as u,B as L,F as R,j as U,x as te,p as q,t as P,v as H}from"./index-CMP0oXC_.js";import{B as se}from"./BaseLayout-BXy9-8K7.js";import{I as ie}from"./InlineLoading-DumhZTSL.js";import{u as re}from"./userStore-DSlhJim0.js";import{g as oe,i as le,e as ne,n as $,b as j,S as X,N as ae,a as z}from"./navigation-DVLPQVor.js";function ue(D){let{swiper:e,extendParams:F,on:v}=D;F({thumbs:{swiper:null,multipleActiveThumbs:!0,autoScrollOffset:0,slideThumbActiveClass:"swiper-slide-thumb-active",thumbsContainerClass:"swiper-thumbs"}});let x=!1,I=!1;e.thumbs={swiper:null};function B(){const r=e.thumbs.swiper;if(!r||r.destroyed)return;const s=r.clickedIndex,d=r.clickedSlide;if(d&&d.classList.contains(e.params.thumbs.slideThumbActiveClass)||typeof s>"u"||s===null)return;let c;r.params.loop?c=parseInt(r.clickedSlide.getAttribute("data-swiper-slide-index"),10):c=s,e.params.loop?e.slideToLoop(c):e.slideTo(c)}function w(){const{thumbs:r}=e.params;if(x)return!1;x=!0;const s=e.constructor;if(r.swiper instanceof s){if(r.swiper.destroyed)return x=!1,!1;e.thumbs.swiper=r.swiper,Object.assign(e.thumbs.swiper.originalParams,{watchSlidesProgress:!0,slideToClickedSlide:!1}),Object.assign(e.thumbs.swiper.params,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper.update()}else if(le(r.swiper)){const d=Object.assign({},r.swiper);Object.assign(d,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper=new s(d),I=!0}return e.thumbs.swiper.el.classList.add(e.params.thumbs.thumbsContainerClass),e.thumbs.swiper.on("tap",B),!0}function p(r){const s=e.thumbs.swiper;if(!s||s.destroyed)return;const d=s.params.slidesPerView==="auto"?s.slidesPerViewDynamic():s.params.slidesPerView;let c=1;const a=e.params.thumbs.slideThumbActiveClass;if(e.params.slidesPerView>1&&!e.params.centeredSlides&&(c=e.params.slidesPerView),e.params.thumbs.multipleActiveThumbs||(c=1),c=Math.floor(c),s.slides.forEach(l=>l.classList.remove(a)),s.params.loop||s.params.virtual&&s.params.virtual.enabled)for(let l=0;l<c;l+=1)ne(s.slidesEl,`[data-swiper-slide-index="${e.realIndex+l}"]`).forEach(n=>{n.classList.add(a)});else for(let l=0;l<c;l+=1)s.slides[e.realIndex+l]&&s.slides[e.realIndex+l].classList.add(a);const m=e.params.thumbs.autoScrollOffset,y=m&&!s.params.loop;if(e.realIndex!==s.realIndex||y){const l=s.activeIndex;let n,k;if(s.params.loop){const i=s.slides.find(T=>T.getAttribute("data-swiper-slide-index")===`${e.realIndex}`);n=s.slides.indexOf(i),k=e.activeIndex>e.previousIndex?"next":"prev"}else n=e.realIndex,k=n>e.previousIndex?"next":"prev";y&&(n+=k==="next"?m:-1*m),s.visibleSlidesIndexes&&s.visibleSlidesIndexes.indexOf(n)<0&&(s.params.centeredSlides?n>l?n=n-Math.floor(d/2)+1:n=n+Math.floor(d/2)-1:n>l&&s.params.slidesPerGroup,s.slideTo(n,r?0:void 0))}}v("beforeInit",()=>{const{thumbs:r}=e.params;if(!(!r||!r.swiper))if(typeof r.swiper=="string"||r.swiper instanceof HTMLElement){const s=oe(),d=()=>{const a=typeof r.swiper=="string"?s.querySelector(r.swiper):r.swiper;if(a&&a.swiper)r.swiper=a.swiper,w(),p(!0);else if(a){const m=`${e.params.eventsPrefix}init`,y=l=>{r.swiper=l.detail[0],a.removeEventListener(m,y),w(),p(!0),r.swiper.update(),e.update()};a.addEventListener(m,y)}return a},c=()=>{if(e.destroyed)return;d()||requestAnimationFrame(c)};requestAnimationFrame(c)}else w(),p(!0)}),v("slideChange update resize observerUpdate",()=>{p()}),v("setTransition",(r,s)=>{const d=e.thumbs.swiper;!d||d.destroyed||d.setTransition(s)}),v("beforeDestroy",()=>{const r=e.thumbs.swiper;!r||r.destroyed||I&&r.destroy()}),Object.assign(e.thumbs,{init:w,update:p})}function de(D){let{swiper:e,extendParams:F,emit:v,once:x}=D;F({freeMode:{enabled:!1,momentum:!0,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,momentumVelocityRatio:1,sticky:!1,minimumVelocity:.02}});function I(){if(e.params.cssMode)return;const p=e.getTranslate();e.setTranslate(p),e.setTransition(0),e.touchEventsData.velocities.length=0,e.freeMode.onTouchEnd({currentPos:e.rtl?e.translate:-e.translate})}function B(){if(e.params.cssMode)return;const{touchEventsData:p,touches:r}=e;p.velocities.length===0&&p.velocities.push({position:r[e.isHorizontal()?"startX":"startY"],time:p.touchStartTime}),p.velocities.push({position:r[e.isHorizontal()?"currentX":"currentY"],time:$()})}function w(p){let{currentPos:r}=p;if(e.params.cssMode)return;const{params:s,wrapperEl:d,rtlTranslate:c,snapGrid:a,touchEventsData:m}=e,l=$()-m.touchStartTime;if(r<-e.minTranslate()){e.slideTo(e.activeIndex);return}if(r>-e.maxTranslate()){e.slides.length<a.length?e.slideTo(a.length-1):e.slideTo(e.slides.length-1);return}if(s.freeMode.momentum){if(m.velocities.length>1){const o=m.velocities.pop(),h=m.velocities.pop(),f=o.position-h.position,N=o.time-h.time;e.velocity=f/N,e.velocity/=2,Math.abs(e.velocity)<s.freeMode.minimumVelocity&&(e.velocity=0),(N>150||$()-o.time>300)&&(e.velocity=0)}else e.velocity=0;e.velocity*=s.freeMode.momentumVelocityRatio,m.velocities.length=0;let n=1e3*s.freeMode.momentumRatio;const k=e.velocity*n;let i=e.translate+k;c&&(i=-i);let T=!1,C;const E=Math.abs(e.velocity)*20*s.freeMode.momentumBounceRatio;let _;if(i<e.maxTranslate())s.freeMode.momentumBounce?(i+e.maxTranslate()<-E&&(i=e.maxTranslate()-E),C=e.maxTranslate(),T=!0,m.allowMomentumBounce=!0):i=e.maxTranslate(),s.loop&&s.centeredSlides&&(_=!0);else if(i>e.minTranslate())s.freeMode.momentumBounce?(i-e.minTranslate()>E&&(i=e.minTranslate()+E),C=e.minTranslate(),T=!0,m.allowMomentumBounce=!0):i=e.minTranslate(),s.loop&&s.centeredSlides&&(_=!0);else if(s.freeMode.sticky){let o;for(let h=0;h<a.length;h+=1)if(a[h]>-i){o=h;break}Math.abs(a[o]-i)<Math.abs(a[o-1]-i)||e.swipeDirection==="next"?i=a[o]:i=a[o-1],i=-i}if(_&&x("transitionEnd",()=>{e.loopFix()}),e.velocity!==0){if(c?n=Math.abs((-i-e.translate)/e.velocity):n=Math.abs((i-e.translate)/e.velocity),s.freeMode.sticky){const o=Math.abs((c?-i:i)-e.translate),h=e.slidesSizesGrid[e.activeIndex];o<h?n=s.speed:o<2*h?n=s.speed*1.5:n=s.speed*2.5}}else if(s.freeMode.sticky){e.slideToClosest();return}s.freeMode.momentumBounce&&T?(e.updateProgress(C),e.setTransition(n),e.setTranslate(i),e.transitionStart(!0,e.swipeDirection),e.animating=!0,j(d,()=>{!e||e.destroyed||!m.allowMomentumBounce||(v("momentumBounce"),e.setTransition(s.speed),setTimeout(()=>{e.setTranslate(C),j(d,()=>{!e||e.destroyed||e.transitionEnd()})},0))})):e.velocity?(v("_freeModeNoMomentumRelease"),e.updateProgress(i),e.setTransition(n),e.setTranslate(i),e.transitionStart(!0,e.swipeDirection),e.animating||(e.animating=!0,j(d,()=>{!e||e.destroyed||e.transitionEnd()}))):e.updateProgress(i),e.updateActiveIndex(),e.updateSlidesClasses()}else if(s.freeMode.sticky){e.slideToClosest();return}else s.freeMode&&v("_freeModeNoMomentumRelease");(!s.freeMode.momentum||l>=s.longSwipesMs)&&(v("_freeModeStaticRelease"),e.updateProgress(),e.updateActiveIndex(),e.updateSlidesClasses())}Object.assign(e,{freeMode:{onTouchStart:I,onTouchMove:B,onTouchEnd:w}})}const ce=""+new URL("../images/share-icon.svg",import.meta.url).href,me={key:0,class:"w-full p-10 text-center"},pe={key:1,class:"ani-fade"},fe={class:"hidden sm:block text-[#85B1CA] text-xs sm:text-sm"},be={class:"flex gap-8 mt-0 sm:mt-2 flex-col md:flex-row lg:gap-12"},ve={class:"w-full lg:w-[calc((100%-48px)/2)]"},he={class:"hidden md:block"},ge=["src"],xe=["src"],we={key:0,class:"block md:hidden"},ye=["src"],Te=["src"],_e=["src"],Se=["src"],Me={key:1,class:"block md:hidden"},ke=["src"],Ce={class:"w-full lg:w-[calc((100%-48px)/2)] relative"},Pe={class:"sticky top-27"},Ie={class:"absolute top-1 right-0 flex gap-3"},Be=["src"],Ee={class:"text-base sm:text-2xl font-bold"},Ae={class:"text-lg sm:text-xl font-bold text-[#3F88B4] mt-1 sm:mt-5"},Fe={class:"text-xs sm:text-sm border-l-5 border-[#BFD6E4] bg-[#F3F3F3] p-4 sm:p-5 text-justify mt-5 sm:mt-7"},Le={class:"text-sm sm:text-base"},De={class:"flex w-full mt-7"},Ve={class:"w-full mt-7"},ze=["disabled"],Oe={class:"mt-10"},Re={class:"border-b border-b-gray-200 mb-5 flex space-x-1"},Ue={__name:"ProductPage",setup(D){const e=K(),F=J(),{isInlineLoading:v}=G(F),x=re(),{favoriteId:I,addLoading:B}=G(x),{addFavorite:w,addCart:p,share:r}=x,{currency:s,imgPath:d}=te(),c=[de,ae,ue],a=V(null),m=_=>{a.value=_},y=e.params.productId,l=V({}),n=V(1);Q(()=>{v.value=!0,k()});async function k(){let _=`https://vue3-course-api.hexschool.io/api/flurrypop-api/product/${y}`;try{const o=await W.get(_);l.value=o.data.product}catch(o){console.error(o)}finally{v.value=!1}}const i=V(1);function T(){i.value<151&&i.value++}function C(){i.value>1&&i.value--}Z(i,()=>{i.value<1&&(i.value=1)});async function E(){try{await p(l.value.id,i.value),i.value=1}catch{}}return(_,o)=>{const h=ee("RouterLink");return g(),O(se,{title:"PRODUCT"},{default:S(()=>[b(v)?(g(),M("div",me,[A(ie)])):(g(),M("div",pe,[t("div",fe,[A(h,{to:{name:"user-product"},class:"hover:underline"},{default:S(()=>o[6]||(o[6]=[u("所有商品")])),_:1,__:[6]}),u(" / "+L(l.value.title),1)]),t("div",be,[t("div",ve,[t("div",he,[t("img",{src:l.value.imageUrl,alt:""},null,8,ge),(g(!0),M(R,null,U(l.value.imagesUrl,f=>(g(),M("img",{src:f,alt:""},null,8,xe))),256))]),l.value.imagesUrl?(g(),M("div",we,[A(b(X),{loop:!1,spaceBetween:10,thumbs:{swiper:a.value},modules:c,class:"mySwiper1"},{default:S(()=>[A(b(z),null,{default:S(()=>[t("img",{src:l.value.imageUrl,loading:"lazy"},null,8,ye)]),_:1}),(g(!0),M(R,null,U(l.value.imagesUrl,f=>(g(),O(b(z),null,{default:S(()=>[t("img",{src:f,loading:"lazy"},null,8,Te)]),_:2},1024))),256))]),_:1},8,["thumbs"]),A(b(X),{onSwiper:m,loop:!1,spaceBetween:10,slidesPerView:4,direction:"horizontal",freeMode:!0,watchSlidesProgress:!0,modules:c,class:"mySwiper2"},{default:S(()=>[A(b(z),null,{default:S(()=>[t("img",{src:l.value.imageUrl,loading:"lazy",class:"slider-img"},null,8,_e)]),_:1}),(g(!0),M(R,null,U(l.value.imagesUrl,f=>(g(),O(b(z),null,{default:S(()=>[t("img",{src:f,loading:"lazy",class:"slider-img"},null,8,Se)]),_:2},1024))),256))]),_:1})])):(g(),M("div",Me,[t("img",{src:l.value.imageUrl,alt:""},null,8,ke)]))]),t("div",Ce,[t("div",Pe,[t("div",Ie,[t("button",{onClick:o[0]||(o[0]=f=>b(w)(l.value.id)),class:"cursor-pointer transition duration-300 hover:scale-110"},[t("img",{src:`${b(I).indexOf(l.value.id)!=-1?`${b(d)}heart-solid-red-icon.svg`:`${b(d)}heart-hollow-red-icon.svg`}`,alt:"",class:"h-5.5"},null,8,Be)]),t("button",{onClick:o[1]||(o[1]=(...f)=>b(r)&&b(r)(...f)),class:"cursor-pointer transition duration-300 hover:scale-110"},o[7]||(o[7]=[t("img",{src:ce,alt:"",class:"h-5.5"},null,-1)]))]),t("div",Ee,L(l.value.title),1),t("div",Ae,"NT$ "+L(b(s)(l.value.price)),1),t("div",Fe,L(l.value.description),1),o[8]||(o[8]=t("div",{class:"mt-5 font-bold text-sm sm:text-base"},"主成分",-1)),t("div",Le,L(l.value.content),1),t("div",De,[t("button",{onClick:C,class:P([i.value>1?"cursor-pointer hover:bg-gray-100":"bg-gray-100","w-10 h-10 border border-gray-200 text-center"])},"-",2),q(t("input",{type:"number","onUpdate:modelValue":o[2]||(o[2]=f=>i.value=f),class:"w-[calc(100%-80px)] border-t border-b border-gray-200 text-center outline-none"},null,512),[[H,i.value,void 0,{number:!0,lazy:!0}]]),t("button",{onClick:T,class:"w-10 h-10 cursor-pointer hover:bg-gray-100 border border-gray-200 text-center"},"+")]),t("div",Ve,[t("button",{onClick:C,class:P([i.value>1?"cursor-pointer hover:bg-gray-100":"bg-gray-100","w-10 h-10 border border-gray-200 text-center"])},"-",2),q(t("input",{type:"number","onUpdate:modelValue":o[3]||(o[3]=f=>i.value=f),class:"w-[calc(100%-80px)] h-10 border-t border-b border-gray-200 text-center outline-none"},null,512),[[H,i.value,void 0,{number:!0,lazy:!0}]]),t("button",{onClick:T,class:"w-10 h-10 cursor-pointer hover:bg-gray-100 border border-gray-200 text-center"},"+")]),t("button",{onClick:E,disabled:b(B),class:P([b(B)?"bg-gray-400":"cursor-pointer bg-[#3F88B4] hover:opacity-90","text-sm sm:text-base w-full text-white p-3 text-center mt-3 transition"])},"加入購物車 ",10,ze)])])]),t("div",Oe,[t("div",Re,[t("button",{onClick:o[4]||(o[4]=f=>n.value=1),class:P([n.value==1?"text-[#3F88B4] border-b-4 border-b-[#3F88B4] ":"cursor-pointer border-b-2 border-b-transparent hover:opacity-80","text-sm sm:text-base px-4 py-2 transition mb-[-1px]"])}," 購買須知 ",2),t("button",{onClick:o[5]||(o[5]=f=>n.value=2),class:P([n.value==2?"text-[#3F88B4] border-b-4 border-b-[#3F88B4]":"cursor-pointer border-b-2 border-b-transparent hover:opacity-80","text-sm sm:text-base px-4 py-2 transition mb-[-1px]"])}," 退換貨須知 ",2)]),t("div",{class:P(n.value==1?"block ani-fade":"hidden opacity-0")},o[9]||(o[9]=[t("ul",{class:"text-xs sm:text-sm list-disc pl-5 space-y-2 text-justify"},[t("li",null,[u("可於 Flurry Pop 官方網站選購冰品，提供"),t("strong",null,"宅配"),u("與"),t("strong",null,"門市自取"),u("兩種方式。建議提前下單以保留心儀風味。")]),t("li",null,[u("我們採用"),t("strong",null,"黑貓冷凍宅配"),u("，全程低溫出貨，僅限"),t("strong",null,"台灣本島"),u("配送。出貨時間為付款後"),t("strong",null,"3–5 個工作天"),u("，特殊節日另行公告。")]),t("li",null,[u("門市提供預訂自取服務，請於結帳時選擇"),t("strong",null,"「門市自取」"),u("，並備註取貨時間。完成付款後，商品將為您保留"),t("strong",null,"2 日"),u("。")]),t("li",null,[u("冰品請於收到後"),t("strong",null,"立即放入冷凍（建議 -18°C 以下）"),u("。天然原料製作，不含防腐劑，建議於"),t("strong",null,"兩週內食用完畢"),u("，風味最佳。 ")]),t("li",null,"所有商品為冷凍保存之食品，因拍攝及顯示器差異，顏色與實品可能略有不同。產品外觀與裝飾可能因批次略有差異，敬請見諒。")],-1)]),2),t("div",{class:P(n.value==2?"block ani-fade":"hidden opacity-0")},o[10]||(o[10]=[t("ul",{class:"text-xs sm:text-sm list-disc pl-5 space-y-2 text-justify"},[t("li",null,[u("因本商品為食品類冷凍商品，依《消費者保護法》第19條及《通訊交易解除權合理例外情事適用準則》，"),t("strong",null,"不適用 7 日鑑賞期規範"),u("。")]),t("li",null,[u("商品經拆封、退冰、食用或因消費者保存不當導致變質，"),t("strong",null,"恕不接受退換貨"),u("。")]),t("li",null,[u("若您收到商品時發現有誤、缺件或瑕疵，請於"),t("strong",null,"到貨後 24 小時內"),u("，透過官方聯絡管道與我們聯繫，並提供相關照片與訂單資訊，我們將盡快為您處理。")]),t("li",null,"退換貨商品請保持原包裝完整（含外箱、配件、發票），以便後續作業。"),t("li",null,[u("如因個人因素（如：無人收貨、填寫錯誤地址、臨時更改心意）導致配送失敗或退件，"),t("strong",null,"將無法提供補寄或退款"),u("，敬請理解。")])],-1)]),2)])]))]),_:1})}}},He=Y(Ue,[["__scopeId","data-v-be8a9b8a"]]);export{He as default};
