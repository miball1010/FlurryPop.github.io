import{_ as I,u as R,s as y,o as V,b as r,h as n,f as m,d as t,w as g,r as P,F as w,k,C as i,y as M,I as z,i as l,j as C,x as $,q as A,v as D,B as q}from"./index-SL7zUako.js";import{I as E}from"./InlineLoading-DsmlpfQW.js";import{u as G}from"./userStore-B9TsC0Gx.js";const H=""+new URL("../images/trash-icon.svg",import.meta.url).href,J={class:"relative py-5 top-55 w-[90%] max-w-[1050px] mx-auto sm:py-0 sm:top-90"},K={key:0,class:"w-full p-10 text-center"},O={key:1},Q={key:0,class:"flex flex-col gap-4 sm:gap-7 justify-center items-center ani-fade"},W={key:1,class:"ani-fade flex flex-col gap-5 lg:flex-row"},X={class:"flex-2"},Y={class:"bg-white shadow-md px-2 sm:px-5"},Z={class:"flex gap-4 sm:gap-5 min-w-0 w-full"},tt=["onClick"],st=["src","alt"],et={class:"flex flex-col flex-1 min-w-0"},ot={class:"sm:font-bold text-sm sm:text-base"},at={class:"font-bold text-[#3F88B4]"},rt={class:"flex w-full max-w-[300px] mt-3"},nt=["onClick"],lt=["onUpdate:modelValue","onChange"],ct=["onClick"],it={class:"p-2 ml-3 mr-0 sm:mr-3 sm:ml-5"},dt=["onClick"],ut={class:"flex-1"},pt={class:"bg-white shadow-md p-4 sm:p-5 flex justify-end flex-col items-end sm:p-5"},_t={class:"w-full border-b border-gray-200"},ft={class:"flex justify-between items-center mb-2"},mt={class:"text-sm sm:text-base"},xt={class:""},ht={class:"mt-2 mb-7"},bt={class:"ml-1 font-bold text-[#3F88B4] text-lg sm:text-xl"},vt={__name:"Step1",setup(yt){const B=z(),{currency:u}=M(),x=R(),{isInlineLoading:h,isFullLoading:b}=y(x),{pushMessage:p}=x,v=G(),{step:N,cart:d,total:j}=y(v),{getCheckProduct:_}=v;V(async()=>{N.value=1,h.value=!0,await _()});function L(e){e.qty>1&&(e.qty--,f(e))}function S(e){e.qty++,f(e)}async function f(e){(e.qty<=0||isNaN(e.qty))&&(e.qty=1),b.value=!0;let o=`https://vue3-course-api.hexschool.io/api/flurrypop-api/cart/${e.id}`;const a={data:{product_id:e.id,qty:e.qty}};try{const s=await q.put(o,a);s.data.success&&_(),p(s.data.success,s.data.message)}catch(s){console.error(s)}finally{b.value=!1}}async function F(e){let o=`https://vue3-course-api.hexschool.io/api/flurrypop-api/cart/${e}`;try{const a=await q.delete(o);a.data.success&&_(),p(a.data.success,a.data.message)}catch(a){p(!1,a.message)}}function T(e){B.push(`/product/${e}`)}return(e,o)=>{const a=P("RouterLink");return l(),r("div",J,[n(h)?(l(),r("div",K,[m(E)])):(l(),r("div",O,[n(d).length==0?(l(),r("div",Q,[o[1]||(o[1]=t("div",{class:"text-[#85B1CA] text-sm sm:text-base"},"目前沒有任何商品",-1)),m(a,{to:{name:"user-product"},class:"btn transition text-white bg-[#3F88B4] hover:opacity-90"},{default:g(()=>o[0]||(o[0]=[C(" 購物去")])),_:1,__:[0]})])):(l(),r("div",W,[t("div",X,[o[2]||(o[2]=t("div",{class:"font-bold mb-2 text-base sm:text-lg"},"購物清單",-1)),t("div",Y,[(l(!0),r(w,null,k(n(d),(s,U)=>(l(),r("div",{class:$([{"border-b border-b-gray-200":n(d).length!=U+1},"flex items-center justify-between py-2 sm:py-5"]),key:s.id},[t("div",Z,[t("div",{onClick:c=>T(s.product.id),class:"cursor-pointer w-20 h-auto sm:w-30 sm:h-30"},[t("img",{src:s.product.imageUrl,alt:s.product.title,class:"w-full h-full object-center object-cover"},null,8,st)],8,tt),t("div",et,[t("div",ot,i(s.product.title),1),t("div",at,"NT$ "+i(n(u)(s.product.price)),1),t("div",rt,[t("button",{onClick:c=>L(s),class:$([s.qty>1?"cursor-pointer hover:bg-gray-100":"bg-gray-100","w-8 aspect-square border border-gray-200 text-center sm:w-10"])},"-",10,nt),A(t("input",{type:"number","onUpdate:modelValue":c=>s.qty=c,onChange:c=>f(s),class:"text-sm sm:text-base flex-1 min-w-0 border-t border-b border-gray-200 text-center outline-none"},null,40,lt),[[D,s.qty,void 0,{number:!0,lazy:!0}]]),t("button",{onClick:c=>S(s),class:"cursor-pointer hover:bg-gray-100 w-8 aspect-square border border-gray-200 text-center sm:w-10"},"+",8,ct)])])]),t("div",it,[t("img",{src:H,alt:"trash-icon",onClick:c=>F(s.id),class:"h-5 sm:h-6 cursor-pointer transition duration-300 hover:scale-110"},null,8,dt)])],2))),128))])]),t("div",ut,[o[5]||(o[5]=t("div",{class:"font-bold mb-2 text-lg hidden lg:block"},"結帳明細",-1)),t("div",pt,[t("div",_t,[(l(!0),r(w,null,k(n(d),s=>(l(),r("div",ft,[t("div",mt,i(s.product.title),1),t("div",xt,"NT$ "+i(n(u)(s.total)),1)]))),256))]),t("div",ht,[o[3]||(o[3]=t("span",{class:"font-bold text-sm sm:text-base"},"總計",-1)),t("span",bt,"NT$ "+i(n(u)(n(j))),1)]),m(a,{to:{name:"user-checkout-step2"},class:"btn bg-[#85B1CA] text-white transition hover:opacity-90"},{default:g(()=>o[4]||(o[4]=[C("下一步 ")])),_:1,__:[4]})])])]))]))])}}},Ct=I(vt,[["__scopeId","data-v-d0dbe7eb"]]);export{Ct as default};
