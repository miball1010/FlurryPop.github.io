import{_ as Y,u as J,s as H,a as K,r as D,B as Q,o as W,C as Z,t as ee,q as R,w as k,i as te,l as h,d as w,h as B,e as s,m as n,D as V,F as j,p as $,j as g,A as N,z as se,k as ie,y as E,v as oe}from"./index-B7y5J1bI.js";import{B as re}from"./BaseLayout--2ZcdRJL.js";import{I as le}from"./InlineLoading-BhBgSRuk.js";import{s as ae}from"./smallLoading-CJBxhfMU.js";import{g as ne,i as ue,e as de,n as q,b as G,S as X,N as ce,a as z}from"./navigation-DoynTFrB.js";function me(O){let{swiper:e,extendParams:L,on:y}=O;L({thumbs:{swiper:null,multipleActiveThumbs:!0,autoScrollOffset:0,slideThumbActiveClass:"swiper-slide-thumb-active",thumbsContainerClass:"swiper-thumbs"}});let _=!1,C=!1;e.thumbs={swiper:null};function M(){const o=e.thumbs.swiper;if(!o||o.destroyed)return;const t=o.clickedIndex,u=o.clickedSlide;if(u&&u.classList.contains(e.params.thumbs.slideThumbActiveClass)||typeof t>"u"||t===null)return;let d;o.params.loop?d=parseInt(o.clickedSlide.getAttribute("data-swiper-slide-index"),10):d=t,e.params.loop?e.slideToLoop(d):e.slideTo(d)}function S(){const{thumbs:o}=e.params;if(_)return!1;_=!0;const t=e.constructor;if(o.swiper instanceof t){if(o.swiper.destroyed)return _=!1,!1;e.thumbs.swiper=o.swiper,Object.assign(e.thumbs.swiper.originalParams,{watchSlidesProgress:!0,slideToClickedSlide:!1}),Object.assign(e.thumbs.swiper.params,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper.update()}else if(ue(o.swiper)){const u=Object.assign({},o.swiper);Object.assign(u,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper=new t(u),C=!0}return e.thumbs.swiper.el.classList.add(e.params.thumbs.thumbsContainerClass),e.thumbs.swiper.on("tap",M),!0}function v(o){const t=e.thumbs.swiper;if(!t||t.destroyed)return;const u=t.params.slidesPerView==="auto"?t.slidesPerViewDynamic():t.params.slidesPerView;let d=1;const a=e.params.thumbs.slideThumbActiveClass;if(e.params.slidesPerView>1&&!e.params.centeredSlides&&(d=e.params.slidesPerView),e.params.thumbs.multipleActiveThumbs||(d=1),d=Math.floor(d),t.slides.forEach(c=>c.classList.remove(a)),t.params.loop||t.params.virtual&&t.params.virtual.enabled)for(let c=0;c<d;c+=1)de(t.slidesEl,`[data-swiper-slide-index="${e.realIndex+c}"]`).forEach(i=>{i.classList.add(a)});else for(let c=0;c<d;c+=1)t.slides[e.realIndex+c]&&t.slides[e.realIndex+c].classList.add(a);const f=e.params.thumbs.autoScrollOffset,T=f&&!t.params.loop;if(e.realIndex!==t.realIndex||T){const c=t.activeIndex;let i,x;if(t.params.loop){const l=t.slides.find(p=>p.getAttribute("data-swiper-slide-index")===`${e.realIndex}`);i=t.slides.indexOf(l),x=e.activeIndex>e.previousIndex?"next":"prev"}else i=e.realIndex,x=i>e.previousIndex?"next":"prev";T&&(i+=x==="next"?f:-1*f),t.visibleSlidesIndexes&&t.visibleSlidesIndexes.indexOf(i)<0&&(t.params.centeredSlides?i>c?i=i-Math.floor(u/2)+1:i=i+Math.floor(u/2)-1:i>c&&t.params.slidesPerGroup,t.slideTo(i,o?0:void 0))}}y("beforeInit",()=>{const{thumbs:o}=e.params;if(!(!o||!o.swiper))if(typeof o.swiper=="string"||o.swiper instanceof HTMLElement){const t=ne(),u=()=>{const a=typeof o.swiper=="string"?t.querySelector(o.swiper):o.swiper;if(a&&a.swiper)o.swiper=a.swiper,S(),v(!0);else if(a){const f=`${e.params.eventsPrefix}init`,T=c=>{o.swiper=c.detail[0],a.removeEventListener(f,T),S(),v(!0),o.swiper.update(),e.update()};a.addEventListener(f,T)}return a},d=()=>{if(e.destroyed)return;u()||requestAnimationFrame(d)};requestAnimationFrame(d)}else S(),v(!0)}),y("slideChange update resize observerUpdate",()=>{v()}),y("setTransition",(o,t)=>{const u=e.thumbs.swiper;!u||u.destroyed||u.setTransition(t)}),y("beforeDestroy",()=>{const o=e.thumbs.swiper;!o||o.destroyed||C&&o.destroy()}),Object.assign(e.thumbs,{init:S,update:v})}function pe(O){let{swiper:e,extendParams:L,emit:y,once:_}=O;L({freeMode:{enabled:!1,momentum:!0,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,momentumVelocityRatio:1,sticky:!1,minimumVelocity:.02}});function C(){if(e.params.cssMode)return;const v=e.getTranslate();e.setTranslate(v),e.setTransition(0),e.touchEventsData.velocities.length=0,e.freeMode.onTouchEnd({currentPos:e.rtl?e.translate:-e.translate})}function M(){if(e.params.cssMode)return;const{touchEventsData:v,touches:o}=e;v.velocities.length===0&&v.velocities.push({position:o[e.isHorizontal()?"startX":"startY"],time:v.touchStartTime}),v.velocities.push({position:o[e.isHorizontal()?"currentX":"currentY"],time:q()})}function S(v){let{currentPos:o}=v;if(e.params.cssMode)return;const{params:t,wrapperEl:u,rtlTranslate:d,snapGrid:a,touchEventsData:f}=e,c=q()-f.touchStartTime;if(o<-e.minTranslate()){e.slideTo(e.activeIndex);return}if(o>-e.maxTranslate()){e.slides.length<a.length?e.slideTo(a.length-1):e.slideTo(e.slides.length-1);return}if(t.freeMode.momentum){if(f.velocities.length>1){const m=f.velocities.pop(),r=f.velocities.pop(),U=m.position-r.position,b=m.time-r.time;e.velocity=U/b,e.velocity/=2,Math.abs(e.velocity)<t.freeMode.minimumVelocity&&(e.velocity=0),(b>150||q()-m.time>300)&&(e.velocity=0)}else e.velocity=0;e.velocity*=t.freeMode.momentumVelocityRatio,f.velocities.length=0;let i=1e3*t.freeMode.momentumRatio;const x=e.velocity*i;let l=e.translate+x;d&&(l=-l);let p=!1,P;const I=Math.abs(e.velocity)*20*t.freeMode.momentumBounceRatio;let A;if(l<e.maxTranslate())t.freeMode.momentumBounce?(l+e.maxTranslate()<-I&&(l=e.maxTranslate()-I),P=e.maxTranslate(),p=!0,f.allowMomentumBounce=!0):l=e.maxTranslate(),t.loop&&t.centeredSlides&&(A=!0);else if(l>e.minTranslate())t.freeMode.momentumBounce?(l-e.minTranslate()>I&&(l=e.minTranslate()+I),P=e.minTranslate(),p=!0,f.allowMomentumBounce=!0):l=e.minTranslate(),t.loop&&t.centeredSlides&&(A=!0);else if(t.freeMode.sticky){let m;for(let r=0;r<a.length;r+=1)if(a[r]>-l){m=r;break}Math.abs(a[m]-l)<Math.abs(a[m-1]-l)||e.swipeDirection==="next"?l=a[m]:l=a[m-1],l=-l}if(A&&_("transitionEnd",()=>{e.loopFix()}),e.velocity!==0){if(d?i=Math.abs((-l-e.translate)/e.velocity):i=Math.abs((l-e.translate)/e.velocity),t.freeMode.sticky){const m=Math.abs((d?-l:l)-e.translate),r=e.slidesSizesGrid[e.activeIndex];m<r?i=t.speed:m<2*r?i=t.speed*1.5:i=t.speed*2.5}}else if(t.freeMode.sticky){e.slideToClosest();return}t.freeMode.momentumBounce&&p?(e.updateProgress(P),e.setTransition(i),e.setTranslate(l),e.transitionStart(!0,e.swipeDirection),e.animating=!0,G(u,()=>{!e||e.destroyed||!f.allowMomentumBounce||(y("momentumBounce"),e.setTransition(t.speed),setTimeout(()=>{e.setTranslate(P),G(u,()=>{!e||e.destroyed||e.transitionEnd()})},0))})):e.velocity?(y("_freeModeNoMomentumRelease"),e.updateProgress(l),e.setTransition(i),e.setTranslate(l),e.transitionStart(!0,e.swipeDirection),e.animating||(e.animating=!0,G(u,()=>{!e||e.destroyed||e.transitionEnd()}))):e.updateProgress(l),e.updateActiveIndex(),e.updateSlidesClasses()}else if(t.freeMode.sticky){e.slideToClosest();return}else t.freeMode&&y("_freeModeNoMomentumRelease");(!t.freeMode.momentum||c>=t.longSwipesMs)&&(y("_freeModeStaticRelease"),e.updateProgress(),e.updateActiveIndex(),e.updateSlidesClasses())}Object.assign(e,{freeMode:{onTouchStart:C,onTouchMove:M,onTouchEnd:S}})}const fe=""+new URL("../images/share-icon.svg",import.meta.url).href,ve={key:0,class:"w-full p-10 text-center"},be={key:1,class:"ani-fade"},he={class:"hidden sm:block text-[#85B1CA] text-xs sm:text-sm"},ge={class:"flex gap-8 mt-0 sm:mt-2 flex-col md:flex-row lg:gap-12"},xe={class:"w-full lg:w-[calc((100%-48px)/2)]"},we={class:"hidden md:block"},ye=["src","alt"],Te=["src","alt"],_e={key:0,class:"block md:hidden"},Se=["src"],ke=["src"],Me=["src"],Ce=["src"],Pe={key:1,class:"block md:hidden"},Ie=["src","alt"],Be={class:"w-full lg:w-[calc((100%-48px)/2)] relative"},Ee={class:"sticky top-27"},Le={class:"absolute top-1 right-0 flex gap-3"},Ae=["src"],Fe={class:"text-base sm:text-2xl font-bold"},De={class:"text-lg sm:text-xl font-bold text-[#3F88B4] mt-1 sm:mt-5"},Ve={class:"text-xs sm:text-sm border-l-5 border-[#BFD6E4] bg-[#F3F3F3] p-4 sm:p-5 text-justify mt-5 sm:mt-7"},Oe={class:"text-sm sm:text-base"},Re={key:0,class:"flex w-full mt-7"},ze=["disabled"],Ue={key:0},je={class:"mt-10"},$e={class:"border-b border-b-gray-200 mb-5 flex space-x-1"},Ne={__name:"ProductPage",setup(O){const e=Q(),L=J(),{isInlineLoading:y}=H(L),_=K(),{favoriteId:C,activeProductId:M}=H(_),{addFavorite:S,addCart:v,shareLink:o}=_,{currency:t,imgPath:u}=se(),d=[pe,ce,me],a=D(null),f=m=>{a.value=m},T=D(!1),c=e.params.productId,i=D({}),x=D(1);W(()=>{T.value=!0,l()});async function l(){let m=`https://vue3-course-api.hexschool.io/api/flurrypop-api/product/${c}`;try{const r=await Z.get(m);i.value=r.data.product}catch(r){console.error(r)}finally{T.value=!1}}const p=D(1);function P(){p.value<151&&p.value++}function I(){p.value>1&&p.value--}ee(p,()=>{p.value<1&&(p.value=1)});async function A(){try{await v(i.value.id,p.value),p.value=1}catch(m){console.log(m)}}return(m,r)=>{const U=te("RouterLink");return h(),R(re,{title:"PRODUCT"},{default:k(()=>[T.value?(h(),w("div",ve,[B(le)])):(h(),w("div",be,[s("div",he,[B(U,{to:{name:"user-product"},class:"hover:underline"},{default:k(()=>r[5]||(r[5]=[n("所有商品")])),_:1,__:[5]}),n(" / "+V(i.value.title),1)]),s("div",ge,[s("div",xe,[s("div",we,[s("img",{src:i.value.imageUrl,alt:i.value.title},null,8,ye),(h(!0),w(j,null,$(i.value.imagesUrl,(b,F)=>(h(),w("img",{src:b,alt:i.value.title,key:F},null,8,Te))),128))]),i.value.imagesUrl?(h(),w("div",_e,[B(g(X),{loop:!1,spaceBetween:10,thumbs:{swiper:a.value},modules:d,class:"mySwiper1"},{default:k(()=>[B(g(z),null,{default:k(()=>[s("img",{src:i.value.imageUrl,loading:"lazy"},null,8,Se)]),_:1}),(h(!0),w(j,null,$(i.value.imagesUrl,(b,F)=>(h(),R(g(z),{key:F},{default:k(()=>[s("img",{src:b,loading:"lazy"},null,8,ke)]),_:2},1024))),128))]),_:1},8,["thumbs"]),B(g(X),{onSwiper:f,loop:!1,spaceBetween:10,slidesPerView:4,direction:"horizontal",freeMode:!0,watchSlidesProgress:!0,modules:d,class:"mySwiper2"},{default:k(()=>[B(g(z),null,{default:k(()=>[s("img",{src:i.value.imageUrl,loading:"lazy",class:"slider-img"},null,8,Me)]),_:1}),(h(!0),w(j,null,$(i.value.imagesUrl,(b,F)=>(h(),R(g(z),{key:F},{default:k(()=>[s("img",{src:b,loading:"lazy",class:"slider-img"},null,8,Ce)]),_:2},1024))),128))]),_:1})])):(h(),w("div",Pe,[s("img",{src:i.value.imageUrl,alt:i.value.title},null,8,Ie)]))]),s("div",Be,[s("div",Ee,[s("div",Le,[i.value.category!="store"?(h(),w("button",{key:0,onClick:r[0]||(r[0]=b=>g(S)(i.value.id,b)),class:"cursor-pointer transition duration-300 hover:scale-110"},[s("img",{src:`${g(C).indexOf(i.value.id)!=-1?`${g(u)}heart-solid-red-icon.svg`:`${g(u)}heart-hollow-red-icon.svg`}`,alt:"heart-icon",class:"h-5.5"},null,8,Ae)])):N("",!0),s("button",{onClick:r[1]||(r[1]=(...b)=>g(o)&&g(o)(...b)),class:"cursor-pointer transition duration-300 hover:scale-110"},r[6]||(r[6]=[s("img",{src:fe,alt:"share-icon",class:"h-5.5"},null,-1)]))]),s("div",Fe,V(i.value.title),1),s("div",De," NT$ "+V(g(t)(i.value.price)),1),s("div",Ve,V(i.value.description),1),r[7]||(r[7]=s("div",{class:"mt-5 font-bold text-sm sm:text-base"},"主成分",-1)),s("div",Oe,V(i.value.content),1),i.value.category!="store"?(h(),w("div",Re,[s("button",{onClick:I,class:E([p.value>1?"cursor-pointer hover:bg-gray-100":"bg-gray-100","w-10 h-10 border border-gray-200 text-center"])}," - ",2),ie(s("input",{type:"number","onUpdate:modelValue":r[2]||(r[2]=b=>p.value=b),class:"w-[calc(100%-80px)] border-t border-b border-gray-200 text-center outline-none"},null,512),[[oe,p.value,void 0,{number:!0,lazy:!0}]]),s("button",{onClick:P,class:"w-10 h-10 cursor-pointer hover:bg-gray-100 border border-gray-200 text-center"}," + ")])):N("",!0),i.value.category!="store"?(h(),w("button",{key:1,onClick:A,disabled:g(M)==i.value.id,class:E([g(M)==i.value.id?"bg-gray-400":"cursor-pointer bg-[#3F88B4] hover:opacity-90","flex justify-center items-center text-sm sm:text-base w-full text-white p-3 text-center mt-3 transition"])},[g(M)!=i.value.id?(h(),w("span",Ue,"加入購物車")):(h(),R(ae,{key:1,color:"white"}))],10,ze)):N("",!0)])])]),s("div",je,[s("div",$e,[s("button",{onClick:r[3]||(r[3]=b=>x.value=1),class:E([x.value==1?"text-[#3F88B4] border-b-4 border-b-[#3F88B4] ":"cursor-pointer border-b-2 border-b-transparent hover:opacity-80","text-sm sm:text-base px-4 py-2 transition mb-[-1px]"])}," 購買須知 ",2),s("button",{onClick:r[4]||(r[4]=b=>x.value=2),class:E([x.value==2?"text-[#3F88B4] border-b-4 border-b-[#3F88B4]":"cursor-pointer border-b-2 border-b-transparent hover:opacity-80","text-sm sm:text-base px-4 py-2 transition mb-[-1px]"])}," 退換貨須知 ",2)]),s("div",{class:E(x.value==1?"block ani-fade":"hidden opacity-0")},r[8]||(r[8]=[s("ul",{class:"text-xs sm:text-sm list-disc pl-5 space-y-2 text-justify"},[s("li",null,[n(" 可於 Flurry Pop 官方網站選購冰品，提供"),s("strong",null,"宅配"),n("與"),s("strong",null,"門市自取"),n("兩種方式。建議提前下單以保留心儀風味。 ")]),s("li",null,[n(" 我們採用"),s("strong",null,"黑貓冷凍宅配"),n("，全程低溫出貨，僅限"),s("strong",null,"台灣本島"),n("配送。出貨時間為付款後"),s("strong",null,"3–5 個工作天"),n("，特殊節日另行公告。 ")]),s("li",null,[n(" 門市提供預訂自取服務，請於結帳時選擇"),s("strong",null,"「門市自取」"),n("，並備註取貨時間。完成付款後，商品將為您保留"),s("strong",null,"2 日"),n("。 ")]),s("li",null,[n(" 冰品請於收到後"),s("strong",null,"立即放入冷凍（建議 -18°C 以下）"),n("。天然原料製作，不含防腐劑，建議於"),s("strong",null,"兩週內食用完畢"),n("，風味最佳。 ")]),s("li",null," 所有商品為冷凍保存之食品，因拍攝及顯示器差異，顏色與實品可能略有不同。產品外觀與裝飾可能因批次略有差異，敬請見諒。 ")],-1)]),2),s("div",{class:E(x.value==2?"block ani-fade":"hidden opacity-0")},r[9]||(r[9]=[s("ul",{class:"text-xs sm:text-sm list-disc pl-5 space-y-2 text-justify"},[s("li",null,[n(" 因本商品為食品類冷凍商品，依《消費者保護法》第19條及《通訊交易解除權合理例外情事適用準則》，"),s("strong",null,"不適用 7 日鑑賞期規範"),n("。 ")]),s("li",null,[n(" 商品經拆封、退冰、食用或因消費者保存不當導致變質，"),s("strong",null,"恕不接受退換貨"),n("。 ")]),s("li",null,[n(" 若您收到商品時發現有誤、缺件或瑕疵，請於"),s("strong",null,"到貨後 24 小時內"),n("，透過官方聯絡管道與我們聯繫，並提供相關照片與訂單資訊，我們將盡快為您處理。 ")]),s("li",null,"退換貨商品請保持原包裝完整（含外箱、配件、發票），以便後續作業。"),s("li",null,[n(" 如因個人因素（如：無人收貨、填寫錯誤地址、臨時更改心意）導致配送失敗或退件，"),s("strong",null,"將無法提供補寄或退款"),n("，敬請理解。 ")])],-1)]),2)])]))]),_:1})}}},Je=Y(Ne,[["__scopeId","data-v-fe5aa488"]]);export{Je as default};
