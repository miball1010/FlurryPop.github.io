import{_ as L,u as U,s as w,a as V,o as M,r as P,d as n,j as r,h as v,e as t,w as k,i as R,F as C,p as $,D as i,z,J as A,l,m as q,y as m,k as E,v as G,M as J,C as N}from"./index-B7y5J1bI.js";import{I as H}from"./InlineLoading-BhBgSRuk.js";const K={class:"relative py-5 top-55 w-[90%] max-w-[1050px] mx-auto sm:py-0 sm:top-90"},O={key:0,class:"w-full p-10 text-center"},Q={key:1},W={key:0,class:"flex flex-col gap-4 sm:gap-7 justify-center items-center ani-fade"},X={key:1,class:"ani-fade flex flex-col gap-5 lg:flex-row"},Y={class:"flex-2"},Z={class:"bg-white shadow-md"},tt={class:"flex gap-4 sm:gap-5 min-w-0 w-full"},st=["onClick"],et=["src","alt"],ot={class:"flex flex-col flex-1 min-w-0"},at={class:"sm:font-bold text-sm sm:text-base"},nt={class:"font-bold text-[#3F88B4]"},rt=["onClick"],lt=["onUpdate:modelValue","onChange"],ct=["onClick"],it={class:"mt-[2px] ml-3 sm:ml-5"},dt=["onClick"],ut={class:"flex-1"},pt={class:"sticky top-25"},_t={class:"bg-white shadow-md p-4 sm:p-5 flex justify-end flex-col items-end"},ft={class:"w-full border-b border-gray-200"},xt={class:"text-sm sm:text-base"},ht={class:""},bt={class:"mt-2 mb-7 sm:mb-12"},vt={class:"ml-1 font-bold text-[#7DB14A] text-lg sm:text-xl"},mt={__name:"Step1",setup(yt){const j=A(),{currency:u}=z(),y=U(),{isInlineLoading:p}=w(y),{pushMessage:_}=y,g=V(),{step:B,cartData:d,total:S}=w(g),{getCheckProduct:f}=g;M(async()=>{B.value=1,p.value=!0,await f(),p.value=!1});function T(e){e.qty>1&&(e.qty--,h(e))}function D(e){e.qty++,h(e)}const x=P("");async function h(e){x.value=e.id,(e.qty<=0||isNaN(e.qty))&&(e.qty=1);let o=`https://vue3-course-api.hexschool.io/api/flurrypop-api/cart/${e.id}`;const a={data:{product_id:e.id,qty:e.qty}};try{const s=await N.put(o,a);s.data.success&&await f(),_(s.data.success,s.data.message)}catch(s){console.error(s)}finally{x.value=""}}async function F(e){let o=`https://vue3-course-api.hexschool.io/api/flurrypop-api/cart/${e}`;try{const a=await N.delete(o);a.data.success&&f(),_(a.data.success,a.data.message)}catch(a){_(!1,a.message)}}function I(e){j.push(`/product/${e}`)}return(e,o)=>{const a=R("RouterLink");return l(),n("div",K,[r(p)?(l(),n("div",O,[v(H)])):(l(),n("div",Q,[r(d).length==0?(l(),n("div",W,[o[1]||(o[1]=t("div",{class:"text-[#70a9ca] text-sm sm:text-base"},"目前沒有任何商品",-1)),v(a,{to:{name:"user-product"},class:"btn transition text-white bg-[#3F88B4] hover:opacity-90"},{default:k(()=>o[0]||(o[0]=[q(" 購物去")])),_:1,__:[0]})])):(l(),n("div",X,[t("div",Y,[o[2]||(o[2]=t("div",{class:"font-bold mb-2 text-base sm:text-lg"},"購物清單",-1)),t("div",Z,[(l(!0),n(C,null,$(r(d),(s,b)=>(l(),n("div",{class:m([{"border-b border-b-gray-200":r(d).length!=b+1},"flex justify-between p-3 sm:p-5"]),key:s.id},[t("div",tt,[t("div",{onClick:c=>I(s.product.id),class:"cursor-pointer w-20 h-auto sm:w-30 sm:h-30"},[t("img",{src:s.product.imageUrl,alt:s.product.title,class:"w-full h-full object-center object-cover"},null,8,et)],8,st),t("div",ot,[t("div",at,i(s.product.title),1),t("div",nt,"NT$ "+i(r(u)(s.product.price)),1),t("div",{class:m(["flex w-full max-w-[300px] mt-3",{"bg-gray-100 pointer-events-none":x.value==s.id}])},[t("button",{onClick:c=>T(s),class:m([s.qty>1?"cursor-pointer hover:bg-gray-100":"bg-gray-100","w-8 aspect-square border border-gray-200 text-center sm:w-10"])}," - ",10,rt),E(t("input",{type:"number","onUpdate:modelValue":c=>s.qty=c,onChange:c=>h(s),class:"text-sm sm:text-base flex-1 min-w-0 border-t border-b border-gray-200 text-center outline-none"},null,40,lt),[[G,s.qty,void 0,{number:!0,lazy:!0}]]),t("button",{onClick:c=>D(s),class:"cursor-pointer hover:bg-gray-100 w-8 aspect-square border border-gray-200 text-center sm:w-10"}," + ",8,ct)],2)])]),t("div",it,[t("img",{src:J,alt:"trash-icon",onClick:c=>F(s.id),class:"h-3 sm:h-4 cursor-pointer transition duration-300 opacity-70 hover:opacity-50"},null,8,dt)])],2))),128))])]),t("div",ut,[t("div",pt,[o[5]||(o[5]=t("div",{class:"font-bold mb-2 text-lg hidden lg:block"},"結帳明細",-1)),t("div",_t,[t("div",ft,[(l(!0),n(C,null,$(r(d),(s,b)=>(l(),n("div",{class:"flex justify-between items-center mb-2",key:b},[t("div",xt,i(s.product.title),1),t("div",ht,"NT$ "+i(r(u)(s.total)),1)]))),128))]),t("div",bt,[o[3]||(o[3]=t("span",{class:"font-bold text-sm sm:text-base"},"總計",-1)),t("span",vt,"NT$ "+i(r(u)(r(S))),1)]),v(a,{to:{name:"user-checkout-step2"},class:"btn bg-[#3F88B4] text-white transition hover:opacity-90"},{default:k(()=>o[4]||(o[4]=[q("下一步 ")])),_:1,__:[4]})])])])]))]))])}}},kt=L(mt,[["__scopeId","data-v-45a90d68"]]);export{kt as default};
